<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VMware → OpenShift Virtualization – 20-Month Migration Report</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
  .freeze { background-color: #ffebee !important; }
  .chill  { background-color: #fff8e1 !important; }
  .ok     { background-color: #e8f5e9 !important; }
  .collapsible { cursor: pointer; }
  .hidden-row { display: none; }
  .chart-container { position: relative; height: 300px; }
</style>
</head>
<body class="bg-light">
<div class="container-fluid p-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2><i class="bi bi-box-arrow-right"></i> VMware → OpenShift Virtualization – 20-Month Migration</h2>
    <div>
      <button class="btn btn-sm btn-outline-primary" onclick="window.print()"><i class="bi bi-printer"></i> Print</button>
      <button class="btn btn-sm btn-outline-danger"  onclick="exportPDF()"><i class="bi bi-file-earmark-pdf"></i> PDF</button>
      <button class="btn btn-sm btn-outline-success" onclick="exportCSV()"><i class="bi bi-file-earmark-spreadsheet"></i> CSV</button>
    </div>
  </div>

  <!-- KPI CARDS -->
  <div class="row mb-4">
    <div class="col-md-3"><div class="card text-center"><div class="card-body"><h5 class="card-title">22,000</h5><p class="card-text">Total VMs</p></div></div></div>
    <div class="col-md-3"><div class="card text-center"><div class="card-body"><h5 class="card-title">100 %</h5><p class="card-text">Thin Storage</p></div></div></div>
    <div class="col-md-3"><div class="card text-center"><div class="card-body"><h5 class="card-title">20</h5><p class="card-text">Months</p></div></div></div>
    <div class="col-md-3"><div class="card text-center"><div class="card-body"><h5 class="card-title">GitOps</h5><p class="card-text">CI/CD</p></div></div></div>
  </div>

  <!-- CHART -->
  <div class="card mb-4"><div class="card-body"><h5>Migration Waves</h5><div class="chart-container"><canvas id="waveChart"></canvas></div></div></div>

  <!-- FILTER BAR -->
  <div class="row mb-3">
    <div class="col"><input class="form-control" id="searchBox" placeholder="Search VM type, wave, month..."></div>
    <div class="col-auto">
      <select class="form-select" id="envFilter"><option value="">All Envs</option><option>Non-Prod</option><option>Prod</option></select>
    </div>
    <div class="col-auto">
      <select class="form-select" id="sizeFilter"><option value="">All Sizes</option><option>≤2 TB</option><option>>2 TB</option></select>
    </div>
  </div>

  <!-- DETAILS TABLE -->
  <div class="table-responsive">
    <table class="table table-sm table-hover" id="detailTable">
      <thead class="table-dark"><tr>
        <th>Month</th><th>Wave</th><th>Env</th><th>VMs</th><th>Size</th><th>Outcome</th><th>Freeze</th>
      </tr></thead>
      <tbody>
        <!-- rows generated by JS -->
      </tbody>
    </table>
  </div>

  <!-- COLLAPSIBLE DETAIL -->
  <div class="accordion my-4" id="accordionDetail">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingOne">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">Thin-Provisioning Automation Details</button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionDetail">
        <div class="accordion-body">
          <ul>
            <li>StorageClass <code>hitachi-thin-block</code> is marked <b>cluster default</b>.</li>
            <li>GitLab CI renders PVC size & attaches to KubeVirt template.</li>
            <li>CSI driver tells Hitachi array to create <b>thin LUN</b> (0 GiB physical at birth).</li>
            <li>Prometheus rule alerts when thin-pool utilisation >80 %.</li>
            <li>Online resize works: <code>kubectl patch pvc ...</code></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="text-muted small">Generated <span id="ts"></span> — VMware Exit Programme</div>
</div>

<script>
// ---- DATA ----
const waves = [
  {month:'Aug-25',wave:0,env:'Non-Prod',vms:10,size:'≤2 TB',outcome:'MTV PoC',freeze:'None',cls:'ok'},
  {month:'Sep-25',wave:1,env:'Non-Prod',vms:200,size:'≤2 TB',outcome:'Cold migration proven',freeze:'None',cls:'ok'},
  {month:'Oct-25',wave:2,env:'Non-Prod',vms:1500,size:'Mixed',outcome:'Warm migration',freeze:'None',cls:'ok'},
  {month:'Nov-25',wave:3,env:'Non-Prod',vms:2000,size:'Mixed',outcome:'GitOps factory',freeze:'None',cls:'ok'},
  {month:'Dec-25',wave:4,env:'Prod',vms:0,size:'',outcome:'Year-end freeze',freeze:'Freeze',cls:'freeze'},
  {month:'Jan-26',wave:5,env:'Prod',vms:2500,size:'≤2 TB',outcome:'Prod cluster live',freeze:'None',cls:'ok'},
  {month:'Feb-26',wave:6,env:'Prod',vms:2500,size:'≤2 TB',outcome:'Linux first',freeze:'None',cls:'ok'},
  {month:'Mar-26',wave:7,env:'Prod',vms:1000,size:'>2 TB',outcome:'Large Linux',freeze:'Chill',cls:'chill'},
  {month:'Apr-26',wave:8,env:'Prod',vms:2000,size:'≤2 TB',outcome:'Windows start',freeze:'None',cls:'ok'},
  {month:'May-26',wave:9,env:'Prod',vms:2000,size:'>2 TB',outcome:'Large Windows',freeze:'None',cls:'ok'},
  {month:'Jun-26',wave:10,env:'Prod',vms:3000,size:'Mixed',outcome:'Final rush',freeze:'Chill',cls:'chill'},
  {month:'Jul-26',wave:11,env:'Prod',vms:2500,size:'Mixed',outcome:'Critical apps',freeze:'None',cls:'ok'},
  {month:'Aug-26',wave:12,env:'Prod',vms:1500,size:'Mixed',outcome:'Orphan VMs',freeze:'Chill',cls:'chill'},
  {month:'Sep-26',wave:13,env:'Prod',vms:0,size:'',outcome:'Decomm VMware',freeze:'None',cls:'ok'},
];

// ---- CHART ----
const ctx = document.getElementById('waveChart');
new Chart(ctx,{
  type:'bar',
  data:{
    labels: waves.map(w=>w.month),
    datasets:[{
      label:'VMs migrated',
      data: waves.map(w=>w.vms),
      backgroundColor:'#0d6efd'
    }]
  },
  options:{
    responsive:true,maintainAspectRatio:false,
    scales:{y:{beginAtZero:true}}
  }
});

// ---- TABLE ----
function renderTable(data){
  const tbody=document.querySelector('#detailTable tbody');
  tbody.innerHTML='';
  data.forEach(w=>{
    const tr=document.createElement('tr');
    tr.className=w.cls;
    tr.innerHTML=`<td>${w.month}</td><td>${w.wave}</td><td>${w.env}</td><td>${w.vms}</td><td>${w.size}</td><td>${w.outcome}</td><td>${w.freeze}</td>`;
    tbody.appendChild(tr);
  });
}
renderTable(waves);

// ---- FILTERS ----
document.getElementById('searchBox').addEventListener('keyup', filter);
document.getElementById('envFilter').addEventListener('change', filter);
document.getElementById('sizeFilter').addEventListener('change', filter);

function filter(){
  const s=document.getElementById('searchBox').value.toLowerCase();
  const e=document.getElementById('envFilter').value;
  const z=document.getElementById('sizeFilter').value;
  const f=waves.filter(w=>
    (w.month.toLowerCase().includes(s)||w.outcome.toLowerCase().includes(s)) &&
    (e===''||w.env===e) &&
    (z===''||w.size.includes(z))
  );
  renderTable(f);
}

// ---- UTILS ----
document.getElementById('ts').textContent=new Date().toLocaleString();

function exportCSV(){
  let csv='Month,Wave,Env,VMs,Size,Outcome,Freeze\n';
  waves.forEach(w=>csv+=`${w.month},${w.wave},${w.env},${w.vms},${w.size},${w.outcome},${w.freeze}\n`);
  const blob=new Blob([csv],{type:'text/csv'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');a.href=url;a.download='migration-report.csv';a.click();
}

function exportPDF(){
  window.print();   // simplest; for true PDF use jspdf+html2canvas if needed
}
</script>
</body>
</html>